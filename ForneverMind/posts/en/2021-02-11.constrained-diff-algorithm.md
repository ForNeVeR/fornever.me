    title: A variant of a diff algorithm for constrained conditions
    description: While working on a GTD application, I had to invent a special modification of a well-known diff algorithm to solve a particular task.
---

# Introduction

One of the projects I currently work on is [Praefectus][praefectus], which will
be a GTD application for my needs.

Several weeks ago, I've decided that one of the first tasks Praefectus will do
will be file renaming: having a set of numbered files on my disk (
say, `1.homework-a.md`, `2.office-work.md`, `3.homework-b.md`) and certain
ordering condition (say, I've decided that all the homework is more important
than any office work today), it should rename the files to match the ordering
condition. As I store my files under a version control system (usually, Git), it
would be good to have it performing only _a minimal set_ of renames: there could
be gaps between items (which may eventually be filled), but for basic rename, to
keep my file history more clean, I'd like it to not rename items that could stay
as-is.

For my example it would mean that Praefectus should only
rename `2.office-work.md` into `4.office-work.md`, and leave number 2
unoccupied.

While investigating different algorithms solving similar problems, I eventually
came to the conclusion that my task is very similar to what
a [diff algorithm][diff-algorithm] would do: having two sequences of items, it
calculates a minimal set of edits on sequence one to get sequence two as the
result.

The task is similar to a diff algorithm one, but it's not the same. Usual diff
algorithm doesn't know anything about item numbering: it just views the input
sequence as a sequence, and "thinks" it could insert any amount of new items
between any two. While this will work for some cases, for some it won't.

For example, let's consider this sequence of items: `1.A`, `3.D`, `4.E`, `5.B`,
`6.C`. A usual diff algorithm would consider taking items `B` and `C`, and
inserting them between `A` and `D`. The problem is there's only one free
position between `A` and `D`, so this particular edit graph is impossible and
shouldn't be considered at all! What's possible is to delete item `3.D` and
insert it as `4.D` (that would require us to also rename `4.E` to free the
space). Though, a better solution would be to move `D` and `E` to the end of the
sequence.

The algorithm should be significantly modified to take item positions into
account. In this article, I'll describe the required algorithm modifications.

# Task Description

Let `A` and `B` to be two sequences of items (equatable to each other),

[diff-algorithm]: https://en.wikipedia.org/wiki/Diff#Algorithm
[praefectus]: https://github.com/ForNeVeR/praefectus/
