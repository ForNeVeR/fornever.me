---
title: UI Automation и TPageControl из библиотеки VCL
description: Работа со страницами VCL TPageControl с помощью .NET UI Automation.
---

[UI Automation](https://msdn.microsoft.com/en-us/library/ms753107(v=vs.110\).aspx) - это механизм, который может быть
использован для разных целей. Мне он сегодня пригодился для взаимодействия с одним полезным устройством, производитель
которого, к сожалению, не предоставил никакого интерфейса для взаимодействия с ним, кроме графического интерфейса под
Windows. Что ж, случается всякое, и такие сценарии тоже иногда хочется автоматизировать.

Программа написана с использованием технологий Borland (да, она достаточно старая), для графического интерфейса
используется старая добрая библиотека VCL.

Есть хороший [пост на StackOverflow](http://stackoverflow.com/a/22641792/2684760), который на простом примере поясняет
работу с UI Automation. Я попытался следовать ему при реализации своего кода, но столкнулся с некоторыми проблемами, в
частности, при работе с компонентом `TPageControl`. В результате каких-то непонятных проблем вкладки внутри этого
контрола неправильно определяются средствами UI Automation. Этот пост посвящён тому, как можно малой кровью обойти эти
ограничения.

Сначала посмотрим на окно программы с помощью [Spy++](https://msdn.microsoft.com/en-us/library/vstudio/dd460760.aspx).

